---
title: Сведения об устранении неполадок для power Automate с помощью скриптов Office
description: Советы, сведения о платформе и известные проблемы с интеграцией между скриптами Office и Power Automate.
ms.date: 01/14/2021
localization_priority: Normal
ms.openlocfilehash: 59f4cd8b3476c2ee2a1a862f136173a543ba8a15
ms.sourcegitcommit: 45ffe3dbd2c834b78592ad35928cf8096f5e80bc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2021
ms.locfileid: "51755009"
---
# <a name="troubleshooting-information-for-power-automate-with-office-scripts"></a><span data-ttu-id="bb058-103">Сведения об устранении неполадок для power Automate с помощью скриптов Office</span><span class="sxs-lookup"><span data-stu-id="bb058-103">Troubleshooting information for Power Automate with Office Scripts</span></span>

<span data-ttu-id="bb058-104">Power Automate позволяет выровизировать автоматизацию скриптов Office на следующий уровень.</span><span class="sxs-lookup"><span data-stu-id="bb058-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="bb058-105">Однако, поскольку Power Automate запускает скрипты от вашего имени в независимых сеансах Excel, необходимо отметить несколько важных моментов.</span><span class="sxs-lookup"><span data-stu-id="bb058-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="bb058-106">Если вы только начинаете использовать скрипты Office с помощью power Automate, начните с запуска скриптов Office с power [Automate,](../develop/power-automate-integration.md) чтобы узнать о платформах.</span><span class="sxs-lookup"><span data-stu-id="bb058-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-using-relative-references"></a><span data-ttu-id="bb058-107">Избегайте использования относительных ссылок</span><span class="sxs-lookup"><span data-stu-id="bb058-107">Avoid using relative references</span></span>

<span data-ttu-id="bb058-108">Power Automate запускает скрипт в выбранной книге Excel от вашего имени.</span><span class="sxs-lookup"><span data-stu-id="bb058-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="bb058-109">Книга может быть закрыта, если это произойдет.</span><span class="sxs-lookup"><span data-stu-id="bb058-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="bb058-110">Любой API, который зависит от текущего состояния пользователя, например, может вести себя `Workbook.getActiveWorksheet` по-другому в Power Automate.</span><span class="sxs-lookup"><span data-stu-id="bb058-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="bb058-111">Это происходит потому, что API основаны на относительном расположении представления пользователя или курсора, и эта ссылка не существует в потоке Power Automate.</span><span class="sxs-lookup"><span data-stu-id="bb058-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="bb058-112">Некоторые относительные API ссылки бросают ошибки в Power Automate.</span><span class="sxs-lookup"><span data-stu-id="bb058-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="bb058-113">Другие имеют поведение по умолчанию, которое подразумевает состояние пользователя.</span><span class="sxs-lookup"><span data-stu-id="bb058-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="bb058-114">При разработке сценариев обязательно используйте абсолютные ссылки для таблиц и диапазонов.</span><span class="sxs-lookup"><span data-stu-id="bb058-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="bb058-115">Это делает поток Power Automate последовательным, даже если таблицы перенастановки.</span><span class="sxs-lookup"><span data-stu-id="bb058-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-power-automate-flows"></a><span data-ttu-id="bb058-116">Методы скрипта, которые не работают при запуске потоков Power Automate</span><span class="sxs-lookup"><span data-stu-id="bb058-116">Script methods that fail when run Power Automate flows</span></span>

<span data-ttu-id="bb058-117">Следующие методы будут бросать ошибку и сбой при призыве из скрипта в потоке Power Automate.</span><span class="sxs-lookup"><span data-stu-id="bb058-117">The following methods will throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="bb058-118">Класс</span><span class="sxs-lookup"><span data-stu-id="bb058-118">Class</span></span> | <span data-ttu-id="bb058-119">Method</span><span class="sxs-lookup"><span data-stu-id="bb058-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="bb058-120">Chart</span><span class="sxs-lookup"><span data-stu-id="bb058-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="bb058-121">Range</span><span class="sxs-lookup"><span data-stu-id="bb058-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="bb058-122">Workbook</span><span class="sxs-lookup"><span data-stu-id="bb058-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="bb058-123">Workbook</span><span class="sxs-lookup"><span data-stu-id="bb058-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="bb058-124">Workbook</span><span class="sxs-lookup"><span data-stu-id="bb058-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="bb058-125">Workbook</span><span class="sxs-lookup"><span data-stu-id="bb058-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="bb058-126">Workbook</span><span class="sxs-lookup"><span data-stu-id="bb058-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="bb058-127">Методы скрипта с поведением по умолчанию в потоках Power Automate</span><span class="sxs-lookup"><span data-stu-id="bb058-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="bb058-128">В следующих методах используется поведение по умолчанию вместо текущего состояния любого пользователя.</span><span class="sxs-lookup"><span data-stu-id="bb058-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="bb058-129">Класс</span><span class="sxs-lookup"><span data-stu-id="bb058-129">Class</span></span> | <span data-ttu-id="bb058-130">Method</span><span class="sxs-lookup"><span data-stu-id="bb058-130">Method</span></span> | <span data-ttu-id="bb058-131">Power Automate behaviour</span><span class="sxs-lookup"><span data-stu-id="bb058-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="bb058-132">Workbook</span><span class="sxs-lookup"><span data-stu-id="bb058-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="bb058-133">Возвращает либо первую таблицу в книге, либо таблицу, активированную `Worksheet.activate` методом.</span><span class="sxs-lookup"><span data-stu-id="bb058-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="bb058-134">Worksheet</span><span class="sxs-lookup"><span data-stu-id="bb058-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="bb058-135">Отмечает таблицу как активную таблицу для целей `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="bb058-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="bb058-136">Выбор книг с управлением браузером файлов</span><span class="sxs-lookup"><span data-stu-id="bb058-136">Select workbooks with the file browser control</span></span>

<span data-ttu-id="bb058-137">При создании шага **запуска сценария** потока Power Automate необходимо выбрать, какая книга является частью потока.</span><span class="sxs-lookup"><span data-stu-id="bb058-137">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="bb058-138">Используйте браузер файлов, чтобы выбрать книгу, а не вручную вводить имя книги.</span><span class="sxs-lookup"><span data-stu-id="bb058-138">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="Действие скрипта Power Automate Run, показывающая параметр браузера файлов Show Picker.":::

<span data-ttu-id="bb058-140">Дополнительные вопросы об ограничении power Automate и обсуждении возможных обходных обходов динамического выбора книг см. в этой теме в [сообществе Microsoft Power Automate.](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#)</span><span class="sxs-lookup"><span data-stu-id="bb058-140">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="bb058-141">Различия часовой зоны</span><span class="sxs-lookup"><span data-stu-id="bb058-141">Time zone differences</span></span>

<span data-ttu-id="bb058-142">Файлы Excel не имеют неотъемлемого расположения или часовой пояс.</span><span class="sxs-lookup"><span data-stu-id="bb058-142">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="bb058-143">Каждый раз, когда пользователь открывает книгу, его сеанс использует локальный часовой пояс пользователя для расчетов дат.</span><span class="sxs-lookup"><span data-stu-id="bb058-143">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="bb058-144">Power Automate всегда использует UTC.</span><span class="sxs-lookup"><span data-stu-id="bb058-144">Power Automate always uses UTC.</span></span>

<span data-ttu-id="bb058-145">Если в сценарии используются даты или время, при локальной проверке скрипта могут возникнуть различия в поведении по сравнению с тем, когда он проходит через Power Automate.</span><span class="sxs-lookup"><span data-stu-id="bb058-145">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="bb058-146">Power Automate позволяет преобразовывать, форматировать и настраивать время.</span><span class="sxs-lookup"><span data-stu-id="bb058-146">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="bb058-147">Сведения о том, как использовать эти функции в Power Automate и [ `main` Parameters:](../develop/power-automate-integration.md#main-parameters-passing-data-to-a-script) Passing data [to](https://flow.microsoft.com/blog/working-with-dates-and-times/) a script, чтобы узнать, как предоставить эти сведения для сценария, см. в инструкции по работе с датами и временем внутри потоков.</span><span class="sxs-lookup"><span data-stu-id="bb058-147">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Passing data to a script](../develop/power-automate-integration.md#main-parameters-passing-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="bb058-148">См. также</span><span class="sxs-lookup"><span data-stu-id="bb058-148">See also</span></span>

- [<span data-ttu-id="bb058-149">Устранение неполадок в сценариях Office</span><span class="sxs-lookup"><span data-stu-id="bb058-149">Troubleshooting Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="bb058-150">Запуск сценариев Office с помощью power Automate</span><span class="sxs-lookup"><span data-stu-id="bb058-150">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="bb058-151">Справочная документация по соединители Excel Online (Бизнес)</span><span class="sxs-lookup"><span data-stu-id="bb058-151">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
