---
title: Устранение Office скриптов
description: Отладка советов и методов для Office скриптов, а также ресурсов справки.
ms.date: 05/17/2021
localization_priority: Normal
ms.openlocfilehash: 04ea0ea5d49d40667d249a6f4f4b109e03362940
ms.sourcegitcommit: 09d8859d5269ada8f1d0e141f6b5a4f96d95a739
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/24/2021
ms.locfileid: "52631705"
---
# <a name="troubleshoot-office-scripts"></a>Устранение Office скриптов

При разработке Office скриптов вы можете ошибаться. Всё в порядке. У вас есть средства, которые помогут найти проблемы и получить ваши сценарии работают идеально.

## <a name="types-of-errors"></a>Типы ошибок

Office Ошибки скриптов подпадают под одну из двух категорий:

* Ошибки и предупреждения по времени компиляции
* Ошибки во время работы

### <a name="compile-time-errors"></a>Ошибки со временем компиляции

Ошибки и предупреждения по времени компиляции сначала показаны в редакторе кода. Они показаны волнистыми красными линиями в редакторе. Они также отображаются в вкладке **Проблемы** в нижней части области задач редактора кода. Выбор ошибки даст дополнительные сведения о проблеме и предложит решения. Ошибки со временем компиляции следует устранить перед запуском сценария.

:::image type="content" source="../images/explicit-any-editor-message.png" alt-text="Ошибка компиляторов, показанная в тексте наведении редактора кода":::

Кроме того, можно увидеть оранжевые предупреждения и серые информационные сообщения. Они указывают на предложения по производительности или другие возможности, при которых сценарий может иметь непреднамеренные последствия. Такие предупреждения следует внимательно исследовать перед их отклонением.

### <a name="runtime-errors"></a>Ошибки во время работы

Ошибки во время работы происходят из-за проблем с логикой в скрипте. Это может быть из-за того, что объект, используемый в сценарии, не находится в книге, таблица отформатирована иначе, чем ожидалось, или некоторыми другими незначительными несоответствиями между требованиями скрипта и текущей книгой. В следующем сценарии создается ошибка, когда нет таблицы с именем "TestSheet".

```TypeScript
function main(workbook: ExcelScript.Workbook) {
  let mySheet = workbook.getWorksheet('TestSheet');

  // This will throw an error if there is no "TestSheet".
  mySheet.getRange("A1");
}
```

### <a name="console-messages"></a>Сообщения консоли

Ошибки времени компилирования и времени работы отображают сообщения об ошибках в консоли при запуске скрипта. Они дают номер строки, где возникла проблема. Имейте в виду, что основной причиной любой проблемы может быть другая строка кода, чем указано на консоли.

На следующем изображении показан выход консоли для [явной ошибки `any` ](../develop/typescript-restrictions.md) компиляторов. Обратите внимание на `[5, 16]` текст в начале строки ошибки. Это означает, что ошибка находится на строке 5, начиная с символа 16.
:::image type="content" source="../images/explicit-any-error-message.png" alt-text="Консоль редактора кода с явным сообщением об ошибке":::

На последующем изображении показан выход консоли для ошибки во время запуска. Здесь сценарий пытается добавить таблицу с именем существующего таблицы. Снова обратите внимание на "Строку 2", предшествуя ошибке, чтобы показать, какую строку следует исследовать.
:::image type="content" source="../images/runtime-error-console.png" alt-text="Консоль редактора кода, отобразив ошибку при вызове &quot;addWorksheet&quot;":::

## <a name="console-logs"></a>Журналы консоли

Печать сообщений на экран с помощью `console.log` заявления. Эти журналы могут показать текущее значение переменных или запускать пути кода. Для этого необходимо вызвать `console.log` любой объект в качестве параметра. Обычно самый `string` простой тип для чтения на консоли.

```TypeScript
console.log("Logging myRange's address.");
console.log(myRange.getAddress());
```

Строки, переданные для отображения в консоли журнала редактора кода, в нижней `console.log` части области задач. Журналы находятся на **вкладке Выход,** хотя вкладка автоматически получает фокус при записи журнала.

Журналы не влияют на книгу.

## <a name="automate-tab-not-appearing-or-office-scripts-unavailable"></a>Автоматизация вкладки, не появляющихся или Office недоступных скриптов

Следующие действия должны помочь устранить проблемы, связанные с вкладками **Automate,** которые не отображаются в Excel в Интернете.

1. [Убедитесь, что Microsoft 365 лицензия включает Office скрипты.](../overview/excel.md#requirements)
1. [Убедитесь, что браузер поддерживается.](platform-limits.md#browser-support)
1. [Убедитесь, что сторонние файлы cookie включены.](platform-limits.md#third-party-cookies)
1. [Убедитесь, что администратор не отключил Office скрипты в центре Microsoft 365 администрирования.](/microsoft-365/admin/manage/manage-office-scripts-settings)

[!INCLUDE [Teams support note](../includes/teams-support-note.md)]

## <a name="troubleshoot-scripts-in-power-automate"></a>Сценарии устранения неполадок в Power Automate

Сведения, специфические для запуска сценариев Power Automate, см. в Office сценариев, [запущенных в Power Automate.](power-automate-troubleshooting.md)

## <a name="help-resources"></a>Ресурсы справки

[Переполнение стека](https://stackoverflow.com/questions/tagged/office-scripts) — это сообщество разработчиков, готовых помочь с проблемами кодирования. Часто вы сможете найти решение проблемы с помощью быстрого поиска переполнения стека. Если нет, задайте свой вопрос и пометите его тегом "Office-scripts". Не забудьте упомянуть, что вы создаете сценарий *Office,* а не Office *надстройки.*

Чтобы отправить запрос на Office скрипты, отправьте свою идею на страницу Голос пользователя [или](https://excel.uservoice.com/forums/274580-excel-for-the-web?category_id=143439)если запрос на функции уже существует, добавьте свой голос за него. Не забудьте подать запрос в Excel веб-страницы в категории "Макрос, скрипты и надстройки".

Если возникла проблема с регистратором действий или редактором, сообщите нам об этом. В меню области задач редактора кода **выберите** кнопку **Отправка** отзывов, чтобы поделиться любыми вопросами.

:::image type="content" source="../images/code-editor-feedback.png" alt-text="Меню редактора кода переполнено кнопкой &quot;Отправить обратную связь&quot;":::

## <a name="see-also"></a>См. также

- [Рекомендации по сценариям Office](../develop/best-practices.md)
- [Ограничения платформы с Office скриптами](platform-limits.md)
- [Повышение производительности Office скриптов](../develop/web-client-performance.md)
- [Устранение Office сценариев, запущенных в PowerAutomate](power-automate-troubleshooting.md)
- [Отмена эффектов сценариев Office](undo.md)
