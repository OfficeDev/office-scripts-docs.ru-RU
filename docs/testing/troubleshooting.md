---
title: Устранение неполадок со скриптами Office
description: Советы и методы отладки для сценариев Office, а также справочные ресурсы.
ms.date: 10/05/2022
ms.localizationpriority: medium
ms.openlocfilehash: 4fe4a9b17d51d078403d1a46abed774d38eeaa80
ms.sourcegitcommit: 64d506257bee282fb01aedbf4d090781b06e4900
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/07/2022
ms.locfileid: "68495469"
---
# <a name="troubleshoot-office-scripts"></a>Устранение неполадок со скриптами Office

При разработке сценариев Office вы можете ошибок. Всё в порядке. У вас есть средства для поиска проблем и идеальной работы скриптов.

> [!NOTE]
> Рекомендации по устранению неполадок, связанных со сценариями Office с помощью Power Automate, см. в разделе "Устранение неполадок сценариев Office, выполняемых [в Power Automate"](power-automate-troubleshooting.md).

## <a name="types-of-errors"></a>Типы ошибок

Ошибки сценариев Office делятся на одну из двух категорий:

* Ошибки или предупреждения во время компиляции
* Ошибки среды выполнения

### <a name="compile-time-errors"></a>Ошибки времени компиляции

Ошибки и предупреждения во время компиляции изначально отображаются в редакторе кода. Они отображаются волнистыми красными подчеркиваниями в редакторе. Они также отображаются на **вкладке "** Проблемы" в нижней части области задач редактора кода. При выборе ошибки вы получите дополнительные сведения о проблеме и предложите решения. Перед выполнением скрипта следует устранить ошибки во время компиляции.

:::image type="content" source="../images/explicit-any-editor-message.png" alt-text="Ошибка компилятора, показанная в тексте наведения редактора кода.":::

Вы также можете увидеть оранжевые подчеркивания предупреждений и серые информационные сообщения. Они указывают на предложения по производительности или другие возможности, при которых сценарий может иметь непреднамеренное влияние. Такие предупреждения следует внимательно изучить перед их закрытием.

### <a name="runtime-errors"></a>Ошибки среды выполнения

Ошибки среды выполнения возникают из-за проблем с логикой в скрипте. Это может быть вызвано тем, что объект, используемый в скрипте, не находится в книге, таблица форматируется иначе, чем ожидалось, или некоторое небольшое несоответствие между требованиями скрипта и текущей книгой. Следующий скрипт создает ошибку, если лист с именем TestSheet отсутствует.

```TypeScript
function main(workbook: ExcelScript.Workbook) {
  let mySheet = workbook.getWorksheet('TestSheet');

  // This will throw an error if there is no "TestSheet".
  mySheet.getRange("A1");
}
```

### <a name="console-messages"></a>Сообщения консоли

Как во время компиляции, так и во время выполнения в консоли отображаются сообщения об ошибках при выполнении скрипта. Они предоставляют номер строки, в которой возникла проблема. Имейте в виду, что первопричиной любой проблемы может быть другая строка кода, чем указано в консоли.

На следующем рисунке показаны выходные данные консоли для [явной `any`](../develop/typescript-restrictions.md) ошибки компилятора. Запишите текст `[5, 16]` в начале строки ошибки. Это означает, что ошибка находится в строке 5, начиная с символа 16.
:::image type="content" source="../images/explicit-any-error-message.png" alt-text="В консоли редактора кода отображается явное сообщение об ошибке &quot;any&quot;.":::

На следующем рисунке показаны выходные данные консоли для ошибки среды выполнения. Здесь скрипт пытается добавить лист с именем существующего листа. Снова обратите внимание на строку 2, предшествуя ошибке, чтобы показать, какую строку следует исследовать.
:::image type="content" source="../images/runtime-error-console.png" alt-text="Консоль редактора кода отображает ошибку из вызова addWorksheet.":::

## <a name="console-logs"></a>Журналы консоли

Выведите сообщения на экран с помощью инструкции `console.log` . Эти журналы могут показать текущее значение переменных или пути кода, которые активируются. Для этого вызовите любой `console.log` объект в качестве параметра. Как правило, самый `string` простой тип для чтения в консоли.

```TypeScript
console.log("Logging myRange's address.");
console.log(myRange.getAddress());
```

Передаваемые строки `console.log` отображаются в консоли ведения журнала редактора кода в нижней части области задач. Журналы находятся на **вкладке "** Вывод", хотя она автоматически получает фокус при записи журнала.

Журналы не влияют на книгу.

## <a name="automate-tab-not-appearing-or-office-scripts-unavailable"></a>Вкладка "Автоматизация" не отображается или сценарии Office недоступны

Следующие действия помогут устранить проблемы, связанные с тем, что вкладка **"** Автоматизация" не отображается в Excel в Интернете.

1. [Убедитесь, что лицензия Microsoft 365 содержит скрипты Office](../overview/excel.md#requirements).
1. [Убедитесь, что браузер поддерживается](platform-limits.md#browser-support).
1. [Убедитесь, что сторонние файлы cookie включены](platform-limits.md#third-party-cookies).
1. [Убедитесь, что администратор не отключает сценарии Office в Центр администрирования Microsoft 365](/microsoft-365/admin/manage/manage-office-scripts-settings).
1. Убедитесь, что вы не вошли в клиент как внешний или гостевой пользователь.

[!INCLUDE [Teams support note](../includes/teams-support-note.md)]

> [!NOTE]
> Существует известная проблема, которая не позволяет сценариям, хранящимся в SharePoint, всегда отображаться в списке недавно использовавшихся. Это происходит, когда администратор отключает веб-службы Exchange (EWS). Сценарии на основе SharePoint по-прежнему доступны и доступны в диалоговом окне файла.

## <a name="help-resources"></a>Справочные ресурсы

[Stack Overflow —](https://stackoverflow.com/questions/tagged/office-scripts) это сообщество разработчиков, готовых помочь в написании кода. Часто вы сможете найти решение проблемы с помощью быстрого поиска Stack Overflow. В противном случае задайте свой вопрос и пометите его тегом office-scripts. Не забудьте упомянуть, что вы создаете *скрипт Office*, а не *надстройку* Office.

## <a name="see-also"></a>См. также

- [Рекомендации по сценариям Office](../develop/best-practices.md)
- [Ограничения платформы с помощью сценариев Office](platform-limits.md)
- [Повышение производительности сценариев Office](../develop/web-client-performance.md)
- [Устранение неполадок сценариев Office, выполняемых в PowerAutomate](power-automate-troubleshooting.md)
- [Отмена эффектов сценариев Office](undo.md)
