---
title: Устранение неполадок Office скриптов
description: Отладка советов и методов для Office скриптов, а также помощь ресурсам.
ms.date: 05/17/2021
localization_priority: Normal
ms.openlocfilehash: ff0ac1e63084c7c541d2a4925f1f011d16fa4992
ms.sourcegitcommit: 4687693f02fc90a57ba30c461f35046e02e6f5fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52545560"
---
# <a name="troubleshoot-office-scripts"></a>Устранение неполадок Office скриптов

При разработке Office скриптов вы можете ошибаться. Всё в порядке. У вас есть инструменты, чтобы помочь найти проблемы и получить ваши сценарии работают отлично.

## <a name="types-of-errors"></a>Типы ошибок

Office Ошибки скриптов подпадают под одну из двух категорий:

* Ошибки или предупреждения в компиляции времени
* Ошибки времени выполнения

### <a name="compile-time-errors"></a>Ошибки времени компиляции

Ошибки и предупреждения в компиляции изначально отображаются в редакторе Кода. Они показаны волнистыми красными подчеркивает в редакторе. Они также отображаются под **вкладкой Проблемы** в нижней части панели задач редактора кода. Выбор ошибки даст более подробную информацию о проблеме и предложит решения. Ошибки времени компиляции должны быть устранены перед запуском скрипта.

:::image type="content" source="../images/explicit-any-editor-message.png" alt-text="Ошибка компилятора, показанная в тексте наведении редактора Кода":::

Вы также можете увидеть оранжевые предупреждающие подчеркиваемы и серые информационные сообщения. Они указывают на производительность предложения или другие возможности, где сценарий может иметь непреднамеренные последствия. Такие предупреждения должны быть тщательно изучены, прежде чем отклонить их.

### <a name="runtime-errors"></a>Ошибки времени выполнения

Ошибки выполнения происходят из-за проблем с логикой в скрипте. Это может быть связано с тем, что объекта, используемого в скрипте, нет в рабочей книге, таблица отформатирована иначе, чем ожидалось, или какое-либо другое незначительное несоответствие между требованиями скрипта и текущей рабочей книгой. Следующий скрипт создает ошибку, когда лист под названием "TestSheet" не присутствует.

```TypeScript
function main(workbook: ExcelScript.Workbook) {
  let mySheet = workbook.getWorksheet('TestSheet');

  // This will throw an error if there is no "TestSheet".
  mySheet.getRange("A1");
}
```

### <a name="console-messages"></a>Консольные сообщения

Ошибки компиляции и времени выполнения отображают сообщения об ошибках в консоли при запуске скрипта. Они дают номер строки, где проблема была решена. Имейте в виду, что основной причиной любой проблемы может быть другая строка кода, чем указано в консоли.

Следующее изображение показывает выход консоли для явной [ошибки `any` компилятора.](../develop/typescript-restrictions.md) Обратите внимание на `[5, 16]` текст в начале строки ошибок. Это указывает на ошибку на строке 5, начиная с символа 16.
:::image type="content" source="../images/explicit-any-error-message.png" alt-text="Консоль редактора кода, отображающая явное сообщение об ошибке «любого»":::

На последующем изображении показан выход консоли при ошибке времени выполнения. Здесь скрипт пытается добавить лист с именем существующего листа. Опять же, обратите внимание на "Линия 2", предшествующая ошибке, чтобы показать, какую строку исследовать.
:::image type="content" source="../images/runtime-error-console.png" alt-text="Консоль редактора кода, отображающая ошибку из вызова 'addWorksheet'":::

## <a name="console-logs"></a>Консольные журналы

Печать сообщений на экран с `console.log` заявлением. Эти журналы могут показать текущее значение переменных или какие пути кода срабатывают. Для этого звоните с `console.log` любым объектом в качестве параметра. Как правило, `string` это самый простой тип для чтения в консоли.

```TypeScript
console.log("Logging myRange's address.");
console.log(myRange.getAddress());
```

Строки, `console.log` переданные для отображения в консоли журнала редактора кода, в нижней части панели задач. Логи находятся на **вкладке Выход,** хотя вкладка автоматически получает фокус, когда журнал написан.

Логи не влияют на рабочую книгу.

## <a name="automate-tab-not-appearing-or-office-scripts-unavailable"></a>Автоматизация вкладки не появляется или Office скрипты недоступны

Следующие шаги должны помочь устранению неполадок в любых проблемах, связанных **с вкладкой Automate,** не появляющимися Excel в Интернете.

1. [Убедитесь, что ваша лицензия Microsoft 365 включает в себя Office скрипты.](../overview/excel.md#requirements)
1. [Убедитесь, что ваш браузер поддерживается.](platform-limits.md#browser-support)
1. [Убедитесь, что сторонние файлы cookie включены.](platform-limits.md#third-party-cookies)
1. [Убедитесь, что администратор не отключил Office скрипты в Microsoft 365 администратора.](/microsoft-365/admin/manage/manage-office-scripts-settings)

[!INCLUDE [Teams support note](../includes/teams-support-note.md)]

## <a name="troubleshoot-scripts-in-power-automate"></a>Скрипты устранения неполадок в Power Automate

Для получения информации, специфичной для запуска скриптов Power Automate, [см Power Automate Office.](power-automate-troubleshooting.md)

## <a name="help-resources"></a>Справка по ресурсам

[Stack Overflow –](https://stackoverflow.com/questions/tagged/office-scripts) это сообщество разработчиков, готовых помочь с проблемами кодирования. Часто вы сможете найти решение вашей проблемы с помощью быстрого поиска переполнения стеков. Если нет, задайте свой вопрос и пометите его тегом "office-scripts". Не забудьте упомянуть, что вы создаете *Office,* а не Office *add-in.*

Если у вас возникла проблема с Office JavaScript API, создайте [проблему в репозитории OfficeDev/office-js](https://github.com/OfficeDev/office-js) GitHub США. Члены группы продуктов будут реагировать на вопросы и оказывать дополнительную помощь. Создание проблемы в **репозитории OfficeDev/office-js** указывает на то, что вы обнаружили дефект в библиотеке API Office JavaScript, который должна устранить группа разработчиков.

Если возникла проблема с регистратором действий или редактором, отправьте отзывы **через кнопку Справка > обратной** связи в Excel.

## <a name="see-also"></a>См. также

- [Рекомендации по сценариям Office](../develop/best-practices.md)
- [Ограничения платформы с Office скриптами](platform-limits.md)
- [Улучшение производительности ваших Office скриптов](../develop/web-client-performance.md)
- [Устранение неполадок Office, работающих в PowerAutomate](power-automate-troubleshooting.md)
- [Отмена эффектов сценариев Office](undo.md)
