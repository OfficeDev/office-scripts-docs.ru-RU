---
title: Сценарии Office в Excel
description: Краткое введение в регистратор действий и редактор кода для сценариев Office.
ms.topic: overview
ms.date: 10/05/2022
ms.localizationpriority: high
ms.openlocfilehash: 02a45e5aae468cff2c61e18b35c54ba656d0484b
ms.sourcegitcommit: 64d506257bee282fb01aedbf4d090781b06e4900
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/07/2022
ms.locfileid: "68495476"
---
# <a name="office-scripts-in-excel"></a>Сценарии Office в Excel

Сценарии Office в Excel позволяют автоматизировать повседневные задачи. Внутри Excel в Интернете действия можно записывать с помощью средства записи действий. При этом создается сценарий на языке TypeScript, который можно запустить снова в любое время. Вы также можете создавать и редактировать сценарии с помощью редактора кода. После этого можно поделиться сценариями в организации, чтобы ваши коллеги также могли автоматизировать свои рабочие процессы.

Эта серия документов научит вас, как использовать эти инструменты. Вы познакомитесь с регистратором действий и узнаете, как записывать ваши частые действия в Excel. Вы также узнаете, как создавать или обновлять свои собственные сценарии с помощью редактора кода.

<br>

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE4qdFF]

## <a name="requirements"></a>Требования

Для использования сценариев Office вам потребуются следующие компоненты.

1. [Excel в Интернете](https://www.office.com/launch/excel) (Excel в Windows может использовать только скрипты Office с [кнопками сценариев](../develop/script-buttons.md)).

    > [!TIP]
    > Сценарии Office теперь доступны в Office для Windows и Mac для [участников программы предварительной оценки Office](https://insider.office.com/).

1. OneDrive для бизнеса.
1. Любая коммерческая или образовательная лицензия Microsoft 365 с доступом к классическим приложениям Microsoft 365 Office, таким как:

    - Office 365 бизнес
    - Office 365 бизнес премиум
    - Office 365 профессиональный плюс
    - Office 365 профессиональный плюс для устройств
    - Office 365 корпоративный E3
    - Office 365 корпоративный E5
    - Office 365 A3
    - Office 365 A5

> [!NOTE]
> Если вы соответствуете этим требованиям и по-прежнему не видите вкладку **Автоматизировать**, возможно, ваш администратор отключил эту функцию или возникла другая проблема с вашей средой. Выполните инструкции из раздела [Не отображается вкладка "Автоматизировать" или недоступны сценарии Office](../testing/troubleshooting.md#automate-tab-not-appearing-or-office-scripts-unavailable), чтоб начать использовать сценарии Office.

## <a name="when-to-use-office-scripts"></a>Когда использовать сценарии Office

Скрипты позволяют записывать и воспроизводить ваши действия Excel в различных рабочих книгах и таблицах. Если вы замечаете, что раз за разом повторяете одинаковые действия, вы можете превратить их в простой сценарий Office. Запускайте свой сценарий нажатием кнопки в Excel или объедините его с Power Automate, чтобы ускорить весь свой рабочий процесс.

Например, скажем, вы начинаете свой рабочий день, открыв файл .csv с сайта учета в Excel. Затем вы тратите несколько минут на удаление ненужных столбцов, форматирование таблицы, добавление формул и создание сводной таблицы на новом листе. Те действия, которые вы повторяете ежедневно, можно записать один раз с помощью регистратора действий. В дальнейшем запуск скрипта позаботится обо всей конвертации CSV. Вы не только устраните риск забывания шагов, но и сможете поделиться своим процессом с другими, не обучая их чему-либо. Сценарии Office позволяют автоматизировать распространенные задачи, чтобы вы и ваше рабочее место могли быть более эффективными и продуктивными.

## <a name="action-recorder"></a>Рекордер действий

:::image type="content" source="../images/action-recorder-intro.png" alt-text="Список действий, записанных с помощью средства записи действий.":::

Средство записи действий записывает действия, выполняемые вами в Excel, и сохраняет их в виде сценария. Когда запущен рекордер действий, вы можете захватывать действия Excel при редактировании ячеек, изменении форматирования и создании таблиц. Полученный сценарий можно запускать на других листах и рабочих книгах, чтобы воссоздать исходные действия.

## <a name="code-editor"></a>Редактор кода

:::image type="content" source="../images/code-editor-intro.png" alt-text="Редактор кода, показывающий код скрипта, используемого в этом руководстве.":::

Все сценарии, записанные с помощью Action Recorder, можно редактировать с помощью редактора кода. Это позволяет настроить и настроить скрипт, чтобы он лучше соответствовал вашим потребностям. Вы также можете добавить логику и функциональные возможности, которые напрямую недоступны через пользовательский интерфейс Excel, такие как условные операторы (если / еще) и циклы.

> [!TIP]
> В средстве записи действий есть кнопка **Копировать как код** для записи действий в код сценария без сохранения всего сценария.
>
> :::image type="content" source="../images/action-recorder-copy-code.png" alt-text="Области задач средства записи действий с выделенной кнопкой &quot;Копировать как код&quot;.":::

Наши [руководства](../tutorials/excel-tutorial.md) предоставляют управляемый и структурированный способ изучения возможностей сценариев Office. После завершения работы с руководствами ознакомьтесь со статьей [Основные сведения о сценариях Office в Excel для Интернета](../develop/scripting-fundamentals.md), чтобы узнать больше о редакторе кода, а также способе записи и изменения собственных сценариев. Дополнительные сведения о редакторе кода и способе интерпретации кода сценария см. в статье [Среда редактора кода сценариев Office](code-editor-environment.md).

## <a name="share-office-scripts"></a>Совместное управление сценариями Office

Сценариями Office можно поделиться с другими пользователям книги Excel. При совместном доступе к сценарию в общей книге все, у кого есть доступ к книге, также смогут просматривать и запускать ваш сценарий. Дополнительные сведения об общем доступе и отмене общего доступа к сценариям см. в статье [Общий доступ к сценариям Office в Excel в Интернете](https://support.microsoft.com/office/226eddbc-3a44-4540-acfe-fccda3d1122b).

:::image type="content" source="../images/script-sharing.png" alt-text="Страница сведений о сценариях, на которой отображается параметр &quot;Поделиться с другими пользователями в этой книге&quot;.":::

Добавьте кнопки, которые запускают сценарии, чтобы помочь коллегам находить ваши ценные решения и позволить им запускать сценарии в Excel Desktop. Узнайте больше о кнопках сценариев в [Запуск сценариев Office с помощью кнопок](../develop/script-buttons.md).

:::image type="content" source="../images/add-button.png" alt-text="Кнопка на листе, которая запускает сценарий при нажатии.":::

> [!NOTE]
> Дополнительные сведения о том, как сценарии сохраняются в OneDrive, см. в статье [Хранение файлов сценариев Office и владение ими](script-storage.md).

## <a name="connect-office-scripts-to-power-automate"></a>Подключение сценариев Office к Power Automate

[Power Automate](https://flow.microsoft.com/) — это служба, которая помогает создавать автоматизированные рабочие процессы между различными приложениями и службами. Сценарии Office можно использовать в этих рабочих процессах, что позволит вам управлять своими сценариями за пределами книги. Вы можете выполнять сценарии по расписанию, активировать их в ответ на сообщения электронной почты и т. д. Чтобы получить основные сведения о подключении этих служб автоматизации, ознакомьтесь с руководством [Выполнение сценариев Office с помощью Power Automate](../tutorials/excel-power-automate-manual.md).

## <a name="next-steps"></a>Дальнейшие действия

Завершите [руководство по сценариям Office в Excel для Интернета](../tutorials/excel-tutorial.md), чтобы узнать, как создать свой первый сценарий.

## <a name="see-also"></a>См. также

- [Основные сведения о сценариях Office в Excel для Интернета](../develop/scripting-fundamentals.md)
- [Справочник API для сценариев Office](/javascript/api/office-scripts/overview)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Параметры сценариев Office в M365](https://support.office.com/article/office-scripts-settings-in-m365-19d3c51a-6ca2-40ab-978d-60fa49554dcf)
- [Общие сведения о сценариях Office в Excel](https://support.microsoft.com/office/9fbe283d-adb8-4f13-a75b-a81c6baf163a)
- [Общий доступ к сценариям Office в веб-программе Excel](https://support.microsoft.com/office/226eddbc-3a44-4540-acfe-fccda3d1122b)
- [Центр разработчиков сценариев Office](https://developer.microsoft.com/office-scripts)
