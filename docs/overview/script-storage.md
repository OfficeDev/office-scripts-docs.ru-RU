---
title: Office и владение файлами скриптов
description: Сведения о том, Office скрипты хранятся в Microsoft OneDrive и передаются между владельцами.
ms.date: 06/01/2022
ms.localizationpriority: medium
ms.openlocfilehash: 17603660bcafa41f898b15b1226d11fa0d51b0a5
ms.sourcegitcommit: aecbd5baf1e2122d836c3eef3b15649e132bc68e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/16/2022
ms.locfileid: "66128211"
---
# <a name="office-scripts-file-storage-and-ownership"></a>Office и владение файлами скриптов

> [!IMPORTANT]
> SharePoint поддержка Office сценариев развертывается и доступна не всем. Он постепенно выпускается для большего количества пользователей, чтобы убедиться в ее правильной работе. Эта функция может быть изменена с учетом ваших отзывов.

Office скрипты хранятся в виде **OSTS-файлов** в Microsoft OneDrive или SharePoint папке. Они хранятся отдельно от книги. Чтобы предоставить пользователям, которые находятся за пределами SharePoint сайта, доступ к скрипту, предоставьте общий доступ к Excel [книге](excel.md#share-office-scripts). Это означает, что вы связываете скрипт с файлом, а не присоединяете его. Пользователь, у которого есть доступ к Excel файла, также сможет просматривать, запускать или создавать копию скрипта.

Excel распознает и запускает скрипт, только если он содержится в папке OneDrive, папке Sharepoint или в книге.

## <a name="onedrive"></a>OneDrive

Поведение по умолчанию — Office скрипты хранятся в OneDrive. **OSTS-файлы** находятся в **папке /Documents/Office Scripts/**. Любые изменения, внесенные в эти **OSTS-файлы** , такие как переименование или удаление файлов, будут отражены в редакторе кода и коллекции скриптов.

Скрипты, совместно используемые с одной из книг, остаются в OneDrive. Они не копируются в локальную или OneDrive при выполнении общего скрипта в Excel. **Кнопка "Создать копию**" редактора кода сохраняет отдельную копию скрипта в OneDrive. Изменения в копии не влияют на исходный скрипт.

Если вы не поделитесь личными скриптами, никто другой не сможет получить к ним доступ. Параметры OneDrive управления общим доступом и разрешениями для всех **OSTS-файлов** скрипта, независимо от Excel параметров. Скрипты нельзя связать с локальным диском или из настраиваемых облачных расположений.

## <a name="sharepoint"></a>SharePoint

Office, сохраненные на SharePoint, принадлежат вашей команде. Вы и члены организации с соответствующим доступом можете запускать и редактировать скрипты из SharePoint. Вы также увидите, что эти скрипты отображаются в  коллекции скриптов вкладки "Автоматизация".

Чтобы загрузить скрипт из SharePoint, перейдите ко всем скриптам и выберите "Просмотреть дополнительные скрипты" в нижней части списка.  Откроется средство выбора файлов, в котором можно выбрать **OSTS-файлы** из любого SharePoint сайта, к которому у вас есть доступ. Обратите внимание, что SharePoint, которые вы уже открыли, будут отображаться в списке последних скриптов.

Чтобы сохранить скрипт в SharePoint, перейдите в меню "Дополнительные **параметры" (...)** и выберите команду **"Сохранить как"**. Откроется средство выбора файлов, в котором можно выбрать папки на SharePoint сайте. При сохранении в новом расположении создается копия скрипта в этом расположении. Исходная версия по-прежнему находится в вашем OneDrive или другом SharePoint расположении.

> [!IMPORTANT]
> Скрипты с [внешними вызовами](../develop/external-calls.md) нельзя запускать из SharePoint. Вы получите сообщение об ошибке "Вызовы сетевого доступа в настоящее время не поддерживаются для сценариев, сохраненных на SharePoint сайте".

> [!IMPORTANT]
> Power Automate **не поддерживает** сценарии, хранящиеся SharePoint в данный момент.

## <a name="restore-deleted-scripts"></a>Восстановление удаленных скриптов

При удалении скрипта в Excel он переходит в корзину OneDrive или SharePoint корзину. Чтобы восстановить удаленный скрипт, выполните действия, описанные в разделе "Восстановление отсутствующих, удаленных или поврежденных элементов в SharePoint и OneDrive для работы или [учебного заведения"](https://support.microsoft.com/office/how-to-recover-missing-deleted-or-corrupted-items-in-sharepoint-and-onedrive-for-work-or-school-3d748edf-c072-46c9-81a4-4989056ebc87). При восстановлении **OSTS-файла** он возвращается в список **"Все скрипты** ".

Удаленный сценарий не является общим для книги. При восстановлении скрипт не **сохраняет** доступ к скрипту. Вам потребуется снова предоставить общий доступ к скрипту.

Восстановленные скрипты по-прежнему работают должным образом с Power Automate потоками. Вам не нужно повторно создавать соединитель потока.

## <a name="file-ownership-and-retention"></a>Владение и хранение файлов

Office скрипты следуют политикам хранения и удаления, указанным Microsoft OneDrive и Microsoft SharePoint. Сведения о том, как обрабатывать сценарии, созданные и совместно используемые пользователем, удаленным из организации, см. в статье о хранении SharePoint и [OneDrive](/microsoft-365/compliance/retention-policies-sharepoint?view=o365-worldwide&preserve-view=true).

Во время редактирования файлы временно хранятся в браузере. Перед закрытием окна Excel необходимо сохранить скрипт, чтобы сохранить его в OneDrive месте. Не забудьте сохранить файл после внося изменений, иначе эти изменения будут доступны только в версии файла в браузере.

## <a name="audit-office-scripts-usage-at-the-admin-level"></a>Аудит Office сценариев на уровне администратора

Узнайте, какие клиенты используют Office скрипты с журналом аудита в Центре соответствия требованиям. Чтобы узнать, как использовать это средство, перейдите в журнал аудита [в Центре соответствия & безопасности](/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance?view=o365-worldwide&preserve-view=true#search-the-audit-log).

Чтобы узнать, кто использует Office скрипты с инструментом поиска, `.osts` добавьте в поле "Файл", "Папка **" или "Сайт**". При этом выполняется поиск всех файлов с расширением Office Scripts. Если кто-либо в вашей организации использовал Office scripts, действие пользователя отображается в результатах поиска по журналу аудита.

## <a name="see-also"></a>См. также

- [Общий доступ к сценариям Office в веб-программе Excel](https://support.microsoft.com/office/226eddbc-3a44-4540-acfe-fccda3d1122b)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Параметры сценариев Office в M365](/microsoft-365/admin/manage/manage-office-scripts-settings)
- [Отмена эффектов сценариев Office](../testing/undo.md)
