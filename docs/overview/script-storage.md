---
title: Хранилище файлов и владение файлами сценариев Office
description: Сведения о том, как сценарии Office хранятся в Microsoft OneDrive и передаются между владельцами.
ms.date: 08/31/2022
ms.localizationpriority: medium
ms.openlocfilehash: 573f65f299c29b4f481c9a2e23ebe7e36181706b
ms.sourcegitcommit: a6504f8b0d6b717457c6e0b5306c35ad3900914e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2022
ms.locfileid: "67572509"
---
# <a name="office-scripts-file-storage-and-ownership"></a>Хранилище файлов и владение файлами сценариев Office

Скрипты Office хранятся в **виде OSTS-файлов** в Microsoft OneDrive или в папке SharePoint. Они хранятся отдельно от книги. Чтобы предоставить пользователям, которые находятся за пределами сайта SharePoint, доступ к скрипту, предоставьте общий доступ к скрипту в [книге Excel](excel.md#share-office-scripts). Это означает, что вы связываете скрипт с файлом, а не присоединяете его. Пользователь, у которого есть доступ к файлу Excel, также сможет просматривать, запускать или создавать копию скрипта.

Excel распознает и запускает сценарий только в том случае, если он есть в папке OneDrive, папке Sharepoint или в книге.

## <a name="onedrive"></a>OneDrive

По умолчанию скрипты Office хранятся в OneDrive. **Osts-файлы** находятся в **папке /Documents/Office Scripts/**. Любые изменения, внесенные в эти **OSTS-файлы** , такие как переименование или удаление файлов, будут отражены в редакторе кода и коллекции скриптов.

Скрипты, совместно используемые с одной из книг, остаются в OneDrive создателя скриптов. Они не копируются ни в одну из локальных папок или в папки OneDrive при выполнении общего скрипта в Excel. **Кнопка "Создать копию**" редактора кода сохраняет отдельную копию скрипта в OneDrive. Изменения в копии не влияют на исходный скрипт.

Если вы не поделитесь личными скриптами, никто другой не сможет получить к ним доступ. Параметры OneDrive могут управлять общим доступом и разрешениями для всех **OSTS-файлов** скриптов, независимо от параметров Excel. Скрипты нельзя связать с локальным диском или из настраиваемых облачных расположений.

## <a name="sharepoint"></a>SharePoint

Скрипты Office, сохраненные на сайте SharePoint, принадлежат вашей команде. Вы и члены организации с соответствующим доступом можете запускать и редактировать сценарии из SharePoint. Вы также увидите, что эти скрипты отображаются в  коллекции скриптов вкладки "Автоматизация".

Чтобы загрузить скрипт из SharePoint, перейдите во все **сценарии** и выберите  "Просмотреть дополнительные скрипты" в нижней части списка. Откроется средство выбора файлов, в котором можно выбрать **OSTS-файлы** с любого сайта SharePoint, к которому у вас есть доступ. Обратите внимание, что сценарии из SharePoint, которые вы уже открыли, будут отображаться в списке последних скриптов.

Чтобы сохранить скрипт в SharePoint, перейдите в меню "Дополнительные **параметры" (...)** и выберите команду **"Сохранить как"**. Откроется средство выбора файлов, в котором можно выбрать папки на сайте SharePoint. При сохранении в новом расположении создается копия скрипта в этом расположении. Исходная версия по-прежнему находится в OneDrive или другом расположении SharePoint.

> [!IMPORTANT]
> Сценарии с [внешними вызовами](../develop/external-calls.md) нельзя запускать из SharePoint. Вы получите сообщение об ошибке "Вызовы сетевого доступа в настоящее время не поддерживаются для сценариев, сохраненных на сайте SharePoint".

> [!IMPORTANT]
> Сейчас Power Automate **не поддерживает** сценарии, хранящиеся в SharePoint.

## <a name="restore-deleted-scripts"></a>Восстановление удаленных скриптов

При удалении скрипта в Excel он переходит в корзину OneDrive или SharePoint. Чтобы восстановить удаленный скрипт, выполните действия, описанные в разделе "Восстановление отсутствующих, удаленных или поврежденных элементов в [SharePoint и OneDrive для работы или учебы"](https://support.microsoft.com/office/how-to-recover-missing-deleted-or-corrupted-items-in-sharepoint-and-onedrive-for-work-or-school-3d748edf-c072-46c9-81a4-4989056ebc87). При восстановлении **OSTS-файла** он возвращается в список **"Все скрипты** ".

Удаленный сценарий не является общим для книги. При восстановлении скрипт не **сохраняет** доступ к скрипту. Вам потребуется снова предоставить общий доступ к скрипту.

Восстановленные скрипты по-прежнему работают должным образом с потоками Power Automate. Вам не нужно повторно создавать соединитель потока.

## <a name="file-ownership-and-retention"></a>Владение и хранение файлов

Скрипты Office следуют политикам хранения и удаления, указанным в Microsoft OneDrive и Microsoft SharePoint. Сведения о том, как обрабатывать сценарии, созданные пользователем, удаленным из организации и к которым предоставлен общий доступ, см. в статье "Хранение для [SharePoint и OneDrive"](/microsoft-365/compliance/retention-policies-sharepoint?view=o365-worldwide&preserve-view=true).

Во время редактирования файлы временно хранятся в браузере. Перед закрытием окна Excel необходимо сохранить скрипт, чтобы сохранить его в расположении OneDrive. Не забудьте сохранить файл после внося изменений, иначе эти изменения будут доступны только в версии файла в браузере.

## <a name="audit-office-scripts-usage-at-the-admin-level"></a>Аудит использования сценариев Office на уровне администратора

Узнайте, кто использует сценарии Office в вашей организации с журналом аудита Центра соответствия требованиям. Сведения о журнале аудита можно найти в журнале поиска в центре [соответствия & безопасности](/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance?view=o365-worldwide&preserve-view=true#search-the-audit-log).

Чтобы в частности выполнить аудит действий, связанных со сценариями Office, от имени администратора, выполните следующие действия.

1. В окне браузера InPrivate (или инкогнито или другом режиме ограниченного отслеживания браузера) откройте центр соответствия требованиям и войдите в [нее](https://compliance.microsoft.com/).
1. Перейдите на **страницу аудита** .
1. *(Только один раз)* На **вкладке "** Поиск" выберите " **Начать запись действий пользователя и администратора"**.

    > [!IMPORTANT]
    > После включения записи может потребоваться час или два, прежде чем будут записаны все действия в клиенте.

1. Задайте нужные параметры поиска и нажмите **клавишу SEARCH**. **Фильтрация действий** **по выполнению скрипта в книге** для просмотра при каждом запуске скрипта. Вы также можете отфильтровать **поле "Файл", "Папка" или "Сайт** " по значению `.osts`. Это показывает, кто в вашей организации создает или изменяет скрипты.

    :::image type="content" source="../images/audit-log-example.png" alt-text="Несколько строк результатов поиска в журнале аудита, включая действие &quot;Запуск скрипта в книге&quot;, а также отправку и изменение OSTS-файла.":::

## <a name="see-also"></a>См. также

- [Общий доступ к сценариям Office в веб-программе Excel](https://support.microsoft.com/office/226eddbc-3a44-4540-acfe-fccda3d1122b)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Параметры сценариев Office в M365](/microsoft-365/admin/manage/manage-office-scripts-settings)
- [Отмена эффектов сценариев Office](../testing/undo.md)
