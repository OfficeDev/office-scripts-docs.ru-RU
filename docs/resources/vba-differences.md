---
title: Различия между сценариями Office и макросами VBA
description: Различия в поведении и API между сценариями Office и макросами VBA для Excel.
ms.date: 06/30/2020
localization_priority: Normal
ms.openlocfilehash: 8a8929f0c6a73a8e9041bb4b55cce1edd539e166
ms.sourcegitcommit: bf9f33c37c6f7805d6b408aa648bb9785a7cd133
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2020
ms.locfileid: "45043393"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="3281f-103">Различия между сценариями Office и макросами VBA</span><span class="sxs-lookup"><span data-stu-id="3281f-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="3281f-104">Сценарии Office и макросы VBA часто встречаются довольно часто.</span><span class="sxs-lookup"><span data-stu-id="3281f-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="3281f-105">Они оба позволяют пользователям автоматизировать решения с помощью удобного средства записи действий и разрешить изменение этих записей.</span><span class="sxs-lookup"><span data-stu-id="3281f-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="3281f-106">Обе платформы предназначены для того, чтобы помочь людям, которые не могут думать, как создавать небольшие программы в Excel.</span><span class="sxs-lookup"><span data-stu-id="3281f-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="3281f-107">Основное различие заключается в том, что макросы VBA разрабатываются для решений для настольных ПК и сценариев Office, разработанных с помощью поддержки нескольких платформ и безопасности в качестве принципов GUID.</span><span class="sxs-lookup"><span data-stu-id="3281f-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed with cross-platform support and security as the guiding principles.</span></span> <span data-ttu-id="3281f-108">В настоящее время сценарии Office поддерживаются только в Excel в Интернете.</span><span class="sxs-lookup"><span data-stu-id="3281f-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

![Схема из четырех квадрантов, в которой показаны области фокусировки для различных решений расширения Office.](../images/office-programmability-diagram.png)

<span data-ttu-id="3281f-111">В этой статье описываются основные различия между макросами VBA (а также VBA в целом) и сценариями Office.</span><span class="sxs-lookup"><span data-stu-id="3281f-111">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="3281f-112">Так как скрипты Office доступны только для Excel, это единственный рассматриваемый узел.</span><span class="sxs-lookup"><span data-stu-id="3281f-112">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="3281f-113">Платформа и экосистема</span><span class="sxs-lookup"><span data-stu-id="3281f-113">Platform and ecosystem</span></span>

<span data-ttu-id="3281f-114">VBA предназначен для настольных систем и сценариев Office, предназначенных для Интернета.</span><span class="sxs-lookup"><span data-stu-id="3281f-114">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="3281f-115">VBA может взаимодействовать с настольным компьютером пользователя для связи с аналогичными технологиями, такими как COM и OLE.</span><span class="sxs-lookup"><span data-stu-id="3281f-115">VBA can interact with a user's desktop to connect with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="3281f-116">Однако VBA не имеет удобного способа позвонить в Интернет.</span><span class="sxs-lookup"><span data-stu-id="3281f-116">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="3281f-117">Сценарии Office используют универсальную среду выполнения или JavaScript.</span><span class="sxs-lookup"><span data-stu-id="3281f-117">Office Scripts use a universal runtime or JavaScript.</span></span> <span data-ttu-id="3281f-118">Это обеспечивает согласованное поведение и специальные возможности, независимо от компьютера, используемого для запуска сценария.</span><span class="sxs-lookup"><span data-stu-id="3281f-118">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="3281f-119">Они также могут совершать вызовы другим веб-службам.</span><span class="sxs-lookup"><span data-stu-id="3281f-119">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="3281f-120">Безопасность</span><span class="sxs-lookup"><span data-stu-id="3281f-120">Security</span></span>

<span data-ttu-id="3281f-121">Макросы VBA имеют тот же зазор безопасности, что и Excel.</span><span class="sxs-lookup"><span data-stu-id="3281f-121">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="3281f-122">Это дает им полный доступ к рабочему столу.</span><span class="sxs-lookup"><span data-stu-id="3281f-122">This gives them full access to your desktop.</span></span> <span data-ttu-id="3281f-123">Сценарии Office имеют доступ только к книге, а не к компьютеру, на котором размещена книга.</span><span class="sxs-lookup"><span data-stu-id="3281f-123">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="3281f-124">Кроме того, с скриптами нельзя предоставлять доступ к маркерам проверки подлинности JavaScript, поэтому сценарии никогда не проходят проверку подлинности с помощью внешней службы.</span><span class="sxs-lookup"><span data-stu-id="3281f-124">Additionally, no JavaScript authentication tokens can be shared with scripts, so scripts can never authenticate with an external service.</span></span>

<span data-ttu-id="3281f-125">У администраторов есть три варианта макросов VBA: разрешить все макросы в клиенте, не разрешать макросы в клиенте или разрешать только макросы с подписанными сертификатами.</span><span class="sxs-lookup"><span data-stu-id="3281f-125">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="3281f-126">Такой недостаток детализации заключается в том, чтобы изолировать одного неисправного субъекта.</span><span class="sxs-lookup"><span data-stu-id="3281f-126">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="3281f-127">В настоящее время сценарии Office либо включены, либо отключены для клиента.</span><span class="sxs-lookup"><span data-stu-id="3281f-127">Currently, Office Scripts are either on or off for a tenant.</span></span> <span data-ttu-id="3281f-128">Однако мы работаем над предоставлением администраторам более контроля над отдельными сценариями и авторами сценариев.</span><span class="sxs-lookup"><span data-stu-id="3281f-128">However, we are working to give admins more control over individual scripts and script creators.</span></span>

## <a name="coverage"></a><span data-ttu-id="3281f-129">Потребностей</span><span class="sxs-lookup"><span data-stu-id="3281f-129">Coverage</span></span>

<span data-ttu-id="3281f-130">В настоящее время VBA предлагает более полное покрытие функций Excel, особенно доступных на настольном клиенте.</span><span class="sxs-lookup"><span data-stu-id="3281f-130">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="3281f-131">Сценарии Office охватывают практически все сценарии для Excel в Интернете.</span><span class="sxs-lookup"><span data-stu-id="3281f-131">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="3281f-132">Кроме того, когда новые функции появятся в Интернете, сценарии Office будут поддерживать их как для средства записи действий, так и для API JavaScript.</span><span class="sxs-lookup"><span data-stu-id="3281f-132">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

## <a name="power-automate"></a><span data-ttu-id="3281f-133">Power Automate</span><span class="sxs-lookup"><span data-stu-id="3281f-133">Power Automate</span></span>

<span data-ttu-id="3281f-134">Сценарии Office можно запускать с помощью автоматизации управления питанием.</span><span class="sxs-lookup"><span data-stu-id="3281f-134">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="3281f-135">Книгу можно обновить с помощью запланированных или управляемых событиями потоков, позволяя автоматизировать рабочие процессы, даже не открывая Excel.</span><span class="sxs-lookup"><span data-stu-id="3281f-135">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="3281f-136">Это означает, что если книга хранится в OneDrive (и доступна для автоматизации), поток может выполнять свои сценарии независимо от того, используете ли вы и ваша организация, Office, Mac или веб-клиент.</span><span class="sxs-lookup"><span data-stu-id="3281f-136">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="3281f-137">В VBA нет соединителя автоматизации Power.</span><span class="sxs-lookup"><span data-stu-id="3281f-137">VBA doesn't have a Power Automate connector.</span></span> <span data-ttu-id="3281f-138">Все поддерживаемые сценарии VBA применяют пользователя к выполнению макроса.</span><span class="sxs-lookup"><span data-stu-id="3281f-138">All supported VBA scenarios involved a user attending to the macro's execution.</span></span>

## <a name="see-also"></a><span data-ttu-id="3281f-139">См. также</span><span class="sxs-lookup"><span data-stu-id="3281f-139">See also</span></span>

- [<span data-ttu-id="3281f-140">Сценарии Office в Excel в Интернете</span><span class="sxs-lookup"><span data-stu-id="3281f-140">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="3281f-141">Различия между сценариями Office и надстройками Office</span><span class="sxs-lookup"><span data-stu-id="3281f-141">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="3281f-142">Устранение неполадок в сценариях Office</span><span class="sxs-lookup"><span data-stu-id="3281f-142">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="3281f-143">Справочник по VBA для Excel</span><span class="sxs-lookup"><span data-stu-id="3281f-143">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
