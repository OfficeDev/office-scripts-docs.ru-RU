---
title: Различия между Office скриптами и макросами VBA
description: Различия между поведением и API между Office скриптами и Excel макросами VBA.
ms.date: 05/21/2021
localization_priority: Normal
ms.openlocfilehash: 0d94607902fa62e07ce378b94ec3b9c328937e16535b1882b6cad5bd76212b33
ms.sourcegitcommit: 75f7ed8c2d23a104acc293f8ce29ea580b4fcdc5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "57847270"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a>Различия между Office скриптами и макросами VBA

Office Скрипты и макрос VBA имеют много общего. Они позволяют пользователям автоматизировать решения с помощью простого в использовании регистратора действий и позволяют изменять эти записи. Обе эти структуры предназначены для того, чтобы предоставить людям, которые могут не считать себя программистами, создавать небольшие программы в Excel.
Основное отличие состоит в том, что макрос VBA разрабатывается для настольных решений, а Office скрипты предназначены для безопасных облачных решений. В настоящее время Office скрипты поддерживаются только в Excel в Интернете.

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Схема с четырьмя квадрантами, показывающая области фокусиза для различных решений Office разностоверных решений. Как Office, так и макрос VBA предназначены для того, чтобы помочь конечным пользователям создавать решения, но Office скрипты создаются для интернета и совместной работы (в то время как VBA предназначена для рабочего стола).":::

В этой статье описываются основные различия между макросами VBA (а также VBA в целом) и Office скриптами. Так Office скрипты доступны только для Excel, это единственный хост, который обсуждается здесь.

## <a name="platform-and-ecosystem"></a>Платформа и экосистема

VBA предназначена для настольного компьютера, Office скрипты предназначены для Интернета. VBA может взаимодействовать с рабочим столом пользователя для подключения к аналогичным технологиям, таким как COM и OLE. Однако У VBA нет удобного способа вызова в Интернете.

Office Сценарии используют универсальное время запуска для JavaScript. Это обеспечивает последовательное поведение и доступность независимо от того, используется ли машина для запуска скрипта. Они также могут звонить в другие веб-службы.

## <a name="security"></a>Безопасность

Макрос VBA имеют тот же уровень безопасности, что и Excel. Это дает им полный доступ к рабочему столу. Office Скрипты имеют доступ только к книге, а не к компьютеру, на который размещена книга. Кроме того, никакие маркеры проверки подлинности JavaScript не могут быть общими для скриптов. Это означает, что сценарий не имеет маркеров подписанного пользователя и не имеет возможностей API для регистрации во внешней службе, поэтому они не могут использовать существующие маркеры для внешних вызовов от имени пользователя.

Администраторы имеют три варианта для макрос VBA: разрешить все макрос на клиенте, не допускать макрос на клиента, или разрешить только макрос с подписанными сертификатами. Отсутствие детализации затрудняет изолирование одного плохого субъекта. В настоящее время Office скрипты могут быть отключены для всего клиента, для всего клиента или для группы пользователей в клиенте. Администраторы также имеют контроль над тем, кто может обмениваться скриптами с другими и кто может использовать сценарии в Power Automate.

## <a name="coverage"></a>Охват

В настоящее время VBA предлагает более полное Excel функций, особенно доступных на настольном клиенте. Office Сценарии охватывают почти все сценарии для Excel в Интернете. Кроме того, по мере дебюта новых функций Office скрипты будут поддерживать их как для API-записи действий, так и для JavaScript.

Office Скрипты не поддерживают события Excel [уровня](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects). Скрипты запускаются только в том случае, если пользователь запускает их вручную или когда поток Power Automate вызывает сценарий.

## <a name="power-automate"></a>Power Automate

Office Скрипты можно запускать через Power Automate. Ваша книга может обновляться с помощью запланированных или управляемых событиями потоков, что позволяет автоматизировать процессы, даже не открывая Excel. Это означает, что до тех пор, пока книга хранится в OneDrive (и доступна для Power Automate), поток может запускать сценарии независимо от того, используете ли вы и ваша организация настольный компьютер Excel, Mac или веб-клиент.

VBA не имеет соединитель Power Automate. Все поддерживаемые сценарии VBA связаны с пользователем, участвующим в выполнении макроса.

Попробуйте [сценарии вызовов](../tutorials/excel-power-automate-manual.md) из руководства Power Automate потока, чтобы начать изучение Power Automate. Вы также можете [](scenarios/task-reminders.md) проверить пример автоматических напоминаний задач, чтобы Office скрипты, подключенные к Teams Power Automate в реальном сценарии.

## <a name="see-also"></a>См. также

- [Сценарии Office в Excel для Интернета](../overview/excel.md)
- [Запустите Office скрипты с Power Automate](../develop/power-automate-integration.md)
- [Различия между сценариями Office и надстройками Office](add-ins-differences.md)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Справочник по VBA для Excel](/office/vba/api/overview/excel)
