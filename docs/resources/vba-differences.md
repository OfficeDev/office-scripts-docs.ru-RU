---
title: Различия между Office скриптами и макросами VBA
description: Поведение и различия API между Office скриптами и Excel VBA.
ms.date: 02/04/2022
ms.localizationpriority: medium
ms.openlocfilehash: 60e4fba6e63967302066f544b76fb20a8c8630a6
ms.sourcegitcommit: 34c7740c9bff0e4c7426e01029f967724bfee566
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/13/2022
ms.locfileid: "65393616"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a>Различия между Office скриптами и макросами VBA

Office скрипты и макросы VBA имеют много общего. Они позволяют пользователям автоматизировать решения с помощью простого в использовании средства записи действий и изменять эти записи. Обе платформы предназначены для того, чтобы пользователи, которые не считают себя программистами, могли создавать небольшие программы в Excel.

Фундаментальным отличием является то, что макросы VBA разрабатываются для классических решений, а Office сценарии предназначены для безопасных облачных решений. В настоящее время Office сценарии поддерживаются только в Excel в Интернете.

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Четырехквадрантная схема, показывающая области фокуса для разных Office расширяемости. Скрипты Office и макросы VBA предназначены для того, чтобы помочь пользователям создавать решения, но Office скрипты создаются для Интернета и совместной работы (в то время как VBA предназначен для настольных компьютеров).":::

В этой статье описываются основные различия между макросами VBA (а также VBA в целом) и Office скриптами. Так Office скрипты доступны только для Excel, это единственный рассматриваемый здесь сайт.

## <a name="platform-and-ecosystem"></a>Платформа и экосистема

VBA поддерживается Excel на Windows Mac. Office сценарии поддерживаются Excel в Интернете.

Эти два решения были разработаны для соответствующих платформ. VBA может взаимодействовать с рабочим столом пользователя для подключения с помощью аналогичных технологий, таких как COM и OLE. Однако VBA не имеет удобного способа вызова в Интернете. Office скрипты используют универсальную среду выполнения для JavaScript. Это обеспечивает согласованное поведение и специальные возможности независимо от компьютера, используемого для выполнения скрипта. Они также могут совершать вызовы к другим веб-службам.

### <a name="script-support-for-excel-on-windows"></a>Поддержка скриптов для Excel на Windows

[!INCLUDE [Run-from-button support](../includes/run-from-button-desktop-support.md)]

## <a name="security"></a>Безопасность

Макросы VBA имеют тот же уровень безопасности, что и Excel. Это предоставляет им полный доступ к рабочему столу. Office скрипты имеют доступ только к книге, а не к компьютеру, на котором размещена книга. Кроме того, скрипты не могут совместно использовать маркеры проверки подлинности JavaScript. Это означает, что у скрипта нет ни маркеров вошедвшего пользователя, ни возможностей API для входа во внешнюю службу, поэтому он не может использовать существующие маркеры для выполнения внешних вызовов от имени пользователя.

У администраторов есть три варианта макросов VBA: разрешить все макросы в клиенте, не разрешать макросы в клиенте или разрешить только макросы со подписанными сертификатами. Отсутствие детализации затрудняет изоляцию одного недопустимого субъекта. В настоящее Office сценарии могут быть отключены для всего клиента, для всего клиента или для группы пользователей в клиенте. Администраторы также имеют контроль над тем, кто может делиться скриптами с другими пользователями и кто может использовать сценарии в Power Automate.

## <a name="coverage"></a>Покрытие

В настоящее время VBA предоставляет более полное Excel функций, особенно доступных на настольном клиенте. Office сценарии охватывают почти все сценарии для Excel в Интернете. Кроме того, по мере того, как новые функции будут доступны в Интернете, Office сценарии будут поддерживать их как для записи действий, так и для API JavaScript.

Office сценарии не поддерживают события [Excel уровня.](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects) Скрипты выполняются только в том случае, если пользователь запускает их вручную или когда поток Power Automate вызывает скрипт.

## <a name="power-automate"></a>Power Automate

Office скрипты можно выполнять через Power Automate. Книгу можно обновить с помощью запланированных или управляемых событиями потоков, что позволяет автоматизировать рабочие процессы, даже не открывая Excel. Это означает, что при условии, что книга хранится в OneDrive (и доступна для Power Automate), поток может выполнять ваши сценарии независимо от того, используете ли вы и ваша организация Excel настольный компьютер, Mac или веб-клиент.

VBA не имеет соединителя Power Automate. Все поддерживаемые сценарии VBA включают пользователя, который будет участвовать в выполнении макроса.

Попробуйте [скрипты вызова из руководства по Power Automate,](../tutorials/excel-power-automate-manual.md) чтобы начать изучение Power Automate. Вы также можете просмотреть пример [](scenarios/task-reminders.md) напоминаний автоматизированных задач, чтобы Office сценарии, подключенные к Teams с помощью Power Automate в реальном сценарии.

## <a name="see-also"></a>См. также

- [Office скрипты в Excel](../overview/excel.md)
- [Выполнение Office с помощью Power Automate](../develop/power-automate-integration.md)
- [Различия между сценариями Office и надстройками Office](add-ins-differences.md)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Справочник по VBA для Excel](/office/vba/api/overview/excel)
