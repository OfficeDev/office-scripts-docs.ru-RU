---
title: Различия между Office скриптами и макросами VBA
description: Различия в поведении и API между Office и Excel макросами VBA.
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 612a5f21d935fd262a6e9fd12a3431956105636a
ms.sourcegitcommit: 4687693f02fc90a57ba30c461f35046e02e6f5fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52545590"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="0a304-103">Различия между Office скриптами и макросами VBA</span><span class="sxs-lookup"><span data-stu-id="0a304-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="0a304-104">Office Сценарии и макросы VBA имеют много общего.</span><span class="sxs-lookup"><span data-stu-id="0a304-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="0a304-105">Они позволяют пользователям автоматизировать решения с помощью простого в использовании диктофона действий и позволяют редактировать эти записи.</span><span class="sxs-lookup"><span data-stu-id="0a304-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="0a304-106">Обе структуры предназначены для того, чтобы дать людям, которые не считают себя программистами, создавать небольшие программы в Excel.</span><span class="sxs-lookup"><span data-stu-id="0a304-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="0a304-107">Принципиальное отличие заключается в том, что макросы VBA разрабатываются для настольных решений, а Office скрипты предназначены для безопасных облачных решений.</span><span class="sxs-lookup"><span data-stu-id="0a304-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed for secure, cloud-based solutions.</span></span> <span data-ttu-id="0a304-108">В настоящее Office скрипты поддерживаются только в Excel в Интернете.</span><span class="sxs-lookup"><span data-stu-id="0a304-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Четырех квадрантная диаграмма, показывающая области фокусировки для различных Office решениях. Как Office, так и макросы VBA предназначены для создания решений для конечных пользователей, но Office скрипты созданы для Интернета и совместной работы (в то время как VBA предназначен для рабочего стола)":::

<span data-ttu-id="0a304-110">В этой статье описаны основные различия между макросами VBA (а также VBA в целом) и Office скриптами.</span><span class="sxs-lookup"><span data-stu-id="0a304-110">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="0a304-111">Поскольку Office скрипты доступны только для Excel, то есть единственный хост обсуждается здесь.</span><span class="sxs-lookup"><span data-stu-id="0a304-111">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="0a304-112">Платформа и экосистема</span><span class="sxs-lookup"><span data-stu-id="0a304-112">Platform and ecosystem</span></span>

<span data-ttu-id="0a304-113">VBA предназначен для настольных компьютеров и Office скрипты предназначены для Интернета.</span><span class="sxs-lookup"><span data-stu-id="0a304-113">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="0a304-114">VBA может взаимодействовать с рабочим столом пользователя для подключения к аналогичным технологиям, таким как COM и OLE.</span><span class="sxs-lookup"><span data-stu-id="0a304-114">VBA can interact with a user's desktop to connect with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="0a304-115">Тем не менее, VBA не имеет удобного способа позвонить в Интернет.</span><span class="sxs-lookup"><span data-stu-id="0a304-115">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="0a304-116">Office Скрипты используют универсальное время выполнения JavaScript.</span><span class="sxs-lookup"><span data-stu-id="0a304-116">Office Scripts use a universal runtime for JavaScript.</span></span> <span data-ttu-id="0a304-117">Это обеспечивает последовательное поведение и доступность, независимо от машины, используемой для запуска скрипта.</span><span class="sxs-lookup"><span data-stu-id="0a304-117">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="0a304-118">Они также могут звонить в другие веб-службы.</span><span class="sxs-lookup"><span data-stu-id="0a304-118">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="0a304-119">Система безопасности</span><span class="sxs-lookup"><span data-stu-id="0a304-119">Security</span></span>

<span data-ttu-id="0a304-120">Макросы VBA имеют тот же допуск безопасности, что и Excel.</span><span class="sxs-lookup"><span data-stu-id="0a304-120">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="0a304-121">Это дает им полный доступ к рабочему столу.</span><span class="sxs-lookup"><span data-stu-id="0a304-121">This gives them full access to your desktop.</span></span> <span data-ttu-id="0a304-122">Office Сценарии имеют доступ только к трудовой книжке, а не к машине, принимающей трудовую книжку.</span><span class="sxs-lookup"><span data-stu-id="0a304-122">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="0a304-123">Кроме того, никакие токены аутентификации JavaScript не могут быть переданы скриптам.</span><span class="sxs-lookup"><span data-stu-id="0a304-123">Additionally, no JavaScript authentication tokens can be shared with scripts.</span></span> <span data-ttu-id="0a304-124">Это означает, что скрипт не имеет ни маркеров пользователя, вокутного в систему, ни возможностей API для регистрации во внешнюю службу, поэтому они не могут использовать существующие токены для внешних звонков от имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="0a304-124">This means the script has neither the tokens of the signed-in user nor are there any API capabilities for signing in to an external service, so they are unable to use existing tokens to make external calls on behalf of the user.</span></span>

<span data-ttu-id="0a304-125">Администраторы имеют три варианта макросов VBA: позволяют все макросы на арендатора, позволяют нет макросов на арендатора, или позволяют только макросы с подписанными сертификатами.</span><span class="sxs-lookup"><span data-stu-id="0a304-125">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="0a304-126">Это отсутствие детализации делает его трудно изолировать одного плохого актера.</span><span class="sxs-lookup"><span data-stu-id="0a304-126">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="0a304-127">В настоящее Office скрипты либо выключены, либо выключены для арендатора.</span><span class="sxs-lookup"><span data-stu-id="0a304-127">Currently, Office Scripts are either on or off for a tenant.</span></span> <span data-ttu-id="0a304-128">Тем не менее, мы работаем, чтобы дать администраторам больше контроля над отдельными скриптами и создателями скриптов.</span><span class="sxs-lookup"><span data-stu-id="0a304-128">However, we are working to give admins more control over individual scripts and script creators.</span></span>

## <a name="coverage"></a><span data-ttu-id="0a304-129">охват</span><span class="sxs-lookup"><span data-stu-id="0a304-129">Coverage</span></span>

<span data-ttu-id="0a304-130">В настоящее время VBA предлагает более полное освещение Excel, особенно тех, которые доступны на рабочем столе клиента.</span><span class="sxs-lookup"><span data-stu-id="0a304-130">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="0a304-131">Office Сценарии охватывают почти все сценарии для Excel в Интернете.</span><span class="sxs-lookup"><span data-stu-id="0a304-131">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="0a304-132">Кроме того, по мере дебюта новых функций в Интернете, Office Scripts будет поддерживать их как для action Recorder, так и для API JavaScript.</span><span class="sxs-lookup"><span data-stu-id="0a304-132">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

<span data-ttu-id="0a304-133">Office Скрипты не Excel на высоком [уровне.](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects)</span><span class="sxs-lookup"><span data-stu-id="0a304-133">Office Scripts don't support Excel-level [events](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects).</span></span> <span data-ttu-id="0a304-134">Сценарии запускаются только тогда, когда пользователь вручную запускает их или Power Automate поток вызывает скрипт.</span><span class="sxs-lookup"><span data-stu-id="0a304-134">Scripts are only run when a user manually starts them or when a Power Automate flow calls the script.</span></span>

## <a name="power-automate"></a><span data-ttu-id="0a304-135">Power Automate</span><span class="sxs-lookup"><span data-stu-id="0a304-135">Power Automate</span></span>

<span data-ttu-id="0a304-136">Office Сценарии можно запустить через Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0a304-136">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="0a304-137">Ваша рабочая книга может обновляться с помощью запланированных или событийных потоков, позволяя автоматизировать рабочие процессы, даже не открывая Excel.</span><span class="sxs-lookup"><span data-stu-id="0a304-137">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="0a304-138">Это означает, что до тех пор, пока ваша рабочая книга хранится в OneDrive (и доступна для Power Automate), поток может запускать ваши скрипты независимо от того, используете ли вы и ваша организация рабочий стол, Mac или веб-клиент Excel.</span><span class="sxs-lookup"><span data-stu-id="0a304-138">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="0a304-139">VBA не имеет разъема Power Automate сети.</span><span class="sxs-lookup"><span data-stu-id="0a304-139">VBA doesn't have a Power Automate connector.</span></span> <span data-ttu-id="0a304-140">Все поддерживаемые сценарии VBA включают пользователя, участвуют в выполнении макроса.</span><span class="sxs-lookup"><span data-stu-id="0a304-140">All supported VBA scenarios involve a user attending to the macro's execution.</span></span>

<span data-ttu-id="0a304-141">Попробуйте [скрипты Call из руководства по Power Automate,](../tutorials/excel-power-automate-manual.md) чтобы начать узнавать об Power Automate.</span><span class="sxs-lookup"><span data-stu-id="0a304-141">Try the [Call scripts from a manual Power Automate flow](../tutorials/excel-power-automate-manual.md) tutorial to start learning about Power Automate.</span></span> <span data-ttu-id="0a304-142">Вы также можете проверить пример [автоматических напоминаний о задачах,](scenarios/task-reminders.md) чтобы Office скрипты, Teams с Power Automate в реальном сценарии.</span><span class="sxs-lookup"><span data-stu-id="0a304-142">You can also check out the [Automated task reminders](scenarios/task-reminders.md) sample to see Office Scripts connected to Teams through Power Automate in a real-world scenario.</span></span>

## <a name="see-also"></a><span data-ttu-id="0a304-143">См. также</span><span class="sxs-lookup"><span data-stu-id="0a304-143">See also</span></span>

- [<span data-ttu-id="0a304-144">Сценарии Office в Excel в Интернете</span><span class="sxs-lookup"><span data-stu-id="0a304-144">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="0a304-145">Вы запустите Office скрипты с Power Automate</span><span class="sxs-lookup"><span data-stu-id="0a304-145">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="0a304-146">Различия между сценариями Office и надстройками Office</span><span class="sxs-lookup"><span data-stu-id="0a304-146">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="0a304-147">Устранение неполадок в сценариях Office</span><span class="sxs-lookup"><span data-stu-id="0a304-147">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="0a304-148">Справочник по VBA для Excel</span><span class="sxs-lookup"><span data-stu-id="0a304-148">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
