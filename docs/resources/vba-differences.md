---
title: Различия между Office скриптами и макросами VBA
description: Различия в поведении и API между Office и Excel макросами VBA.
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 612a5f21d935fd262a6e9fd12a3431956105636a
ms.sourcegitcommit: 4687693f02fc90a57ba30c461f35046e02e6f5fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52545590"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a>Различия между Office скриптами и макросами VBA

Office Сценарии и макросы VBA имеют много общего. Они позволяют пользователям автоматизировать решения с помощью простого в использовании диктофона действий и позволяют редактировать эти записи. Обе структуры предназначены для того, чтобы дать людям, которые не считают себя программистами, создавать небольшие программы в Excel.
Принципиальное отличие заключается в том, что макросы VBA разрабатываются для настольных решений, а Office скрипты предназначены для безопасных облачных решений. В настоящее Office скрипты поддерживаются только в Excel в Интернете.

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Четырех квадрантная диаграмма, показывающая области фокусировки для различных Office решениях. Как Office, так и макросы VBA предназначены для создания решений для конечных пользователей, но Office скрипты созданы для Интернета и совместной работы (в то время как VBA предназначен для рабочего стола)":::

В этой статье описаны основные различия между макросами VBA (а также VBA в целом) и Office скриптами. Поскольку Office скрипты доступны только для Excel, то есть единственный хост обсуждается здесь.

## <a name="platform-and-ecosystem"></a>Платформа и экосистема

VBA предназначен для настольных компьютеров и Office скрипты предназначены для Интернета. VBA может взаимодействовать с рабочим столом пользователя для подключения к аналогичным технологиям, таким как COM и OLE. Тем не менее, VBA не имеет удобного способа позвонить в Интернет.

Office Скрипты используют универсальное время выполнения JavaScript. Это обеспечивает последовательное поведение и доступность, независимо от машины, используемой для запуска скрипта. Они также могут звонить в другие веб-службы.

## <a name="security"></a>Система безопасности

Макросы VBA имеют тот же допуск безопасности, что и Excel. Это дает им полный доступ к рабочему столу. Office Сценарии имеют доступ только к трудовой книжке, а не к машине, принимающей трудовую книжку. Кроме того, никакие токены аутентификации JavaScript не могут быть переданы скриптам. Это означает, что скрипт не имеет ни маркеров пользователя, вокутного в систему, ни возможностей API для регистрации во внешнюю службу, поэтому они не могут использовать существующие токены для внешних звонков от имени пользователя.

Администраторы имеют три варианта макросов VBA: позволяют все макросы на арендатора, позволяют нет макросов на арендатора, или позволяют только макросы с подписанными сертификатами. Это отсутствие детализации делает его трудно изолировать одного плохого актера. В настоящее Office скрипты либо выключены, либо выключены для арендатора. Тем не менее, мы работаем, чтобы дать администраторам больше контроля над отдельными скриптами и создателями скриптов.

## <a name="coverage"></a>охват

В настоящее время VBA предлагает более полное освещение Excel, особенно тех, которые доступны на рабочем столе клиента. Office Сценарии охватывают почти все сценарии для Excel в Интернете. Кроме того, по мере дебюта новых функций в Интернете, Office Scripts будет поддерживать их как для action Recorder, так и для API JavaScript.

Office Скрипты не Excel на высоком [уровне.](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects) Сценарии запускаются только тогда, когда пользователь вручную запускает их или Power Automate поток вызывает скрипт.

## <a name="power-automate"></a>Power Automate

Office Сценарии можно запустить через Power Automate. Ваша рабочая книга может обновляться с помощью запланированных или событийных потоков, позволяя автоматизировать рабочие процессы, даже не открывая Excel. Это означает, что до тех пор, пока ваша рабочая книга хранится в OneDrive (и доступна для Power Automate), поток может запускать ваши скрипты независимо от того, используете ли вы и ваша организация рабочий стол, Mac или веб-клиент Excel.

VBA не имеет разъема Power Automate сети. Все поддерживаемые сценарии VBA включают пользователя, участвуют в выполнении макроса.

Попробуйте [скрипты Call из руководства по Power Automate,](../tutorials/excel-power-automate-manual.md) чтобы начать узнавать об Power Automate. Вы также можете проверить пример [автоматических напоминаний о задачах,](scenarios/task-reminders.md) чтобы Office скрипты, Teams с Power Automate в реальном сценарии.

## <a name="see-also"></a>См. также

- [Сценарии Office в Excel в Интернете](../overview/excel.md)
- [Вы запустите Office скрипты с Power Automate](../develop/power-automate-integration.md)
- [Различия между сценариями Office и надстройками Office](add-ins-differences.md)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Справочник по VBA для Excel](/office/vba/api/overview/excel)
