---
title: Различия между сценариями Office и макросами VBA
description: Различия в поведении и API между сценариями Office и макросами VBA для Excel.
ms.date: 11/13/2020
localization_priority: Normal
ms.openlocfilehash: 7b9186d03489a43836c6e9da7bd28e0abc135f63
ms.sourcegitcommit: 82d3c0ef1e187bcdeceb2b5fc3411186674fe150
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "49342887"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a>Различия между сценариями Office и макросами VBA

Сценарии Office и макросы VBA часто встречаются довольно часто. Они оба позволяют пользователям автоматизировать решения с помощью удобного средства записи действий и разрешить изменение этих записей. Обе платформы предназначены для того, чтобы помочь людям, которые не могут думать, как создавать небольшие программы в Excel.
Основное различие заключается в том, что макросы VBA разрабатываются для решений для настольных ПК и сценариев Office, разработанных с помощью поддержки нескольких платформ и безопасности в качестве принципов GUID. В настоящее время сценарии Office поддерживаются только в Excel в Интернете.

![Схема из четырех квадрантов, в которой показаны области фокусировки для различных решений расширения Office. Сценарии Office и макросы VBA предназначены для помощи конечным пользователям при создании решений, но сценарии Office создаются для Интернета и совместной работы (в то время как VBA — для рабочего стола).)](../images/office-programmability-diagram.png)

В этой статье описываются основные различия между макросами VBA (а также VBA в целом) и сценариями Office. Так как скрипты Office доступны только для Excel, это единственный рассматриваемый узел.

## <a name="platform-and-ecosystem"></a>Платформа и экосистема

VBA предназначен для настольных систем и сценариев Office, предназначенных для Интернета. VBA может взаимодействовать с настольным компьютером пользователя для связи с аналогичными технологиями, такими как COM и OLE. Однако VBA не имеет удобного способа позвонить в Интернет.

Сценарии Office используют универсальную среду выполнения для JavaScript. Это обеспечивает согласованное поведение и специальные возможности, независимо от компьютера, используемого для запуска сценария. Они также могут совершать вызовы другим веб-службам.

## <a name="security"></a>Безопасность

Макросы VBA имеют тот же зазор безопасности, что и Excel. Это дает им полный доступ к рабочему столу. Сценарии Office имеют доступ только к книге, а не к компьютеру, на котором размещена книга. Кроме того, сценарии проверки подлинности JavaScript не могут использоваться совместно с скриптами. Это означает, что сценарий не имеет маркеров пользователя, выполнившего вход, и не имеет возможностей API для входа в внешнюю службу, поэтому они не могут использовать существующие маркеры для выполнения внешних вызовов от имени пользователя.

У администраторов есть три варианта макросов VBA: разрешить все макросы в клиенте, не разрешать макросы в клиенте или разрешать только макросы с подписанными сертификатами. Такой недостаток детализации заключается в том, чтобы изолировать одного неисправного субъекта. В настоящее время сценарии Office либо включены, либо отключены для клиента. Однако мы работаем над предоставлением администраторам более контроля над отдельными сценариями и авторами сценариев.

## <a name="coverage"></a>Потребностей

В настоящее время VBA предлагает более полное покрытие функций Excel, особенно доступных на настольном клиенте. Сценарии Office охватывают практически все сценарии для Excel в Интернете. Кроме того, когда новые функции появятся в Интернете, сценарии Office будут поддерживать их как для средства записи действий, так и для API JavaScript.

## <a name="power-automate"></a>Power Automate

Сценарии Office можно запускать с помощью автоматизации управления питанием. Книгу можно обновить с помощью запланированных или управляемых событиями потоков, позволяя автоматизировать рабочие процессы, даже не открывая Excel. Это означает, что если книга хранится в OneDrive (и доступна для автоматизации), поток может выполнять свои сценарии независимо от того, используете ли вы и ваша организация, Office, Mac или веб-клиент.

В VBA нет соединителя автоматизации Power. Все поддерживаемые сценарии VBA применяют пользователя к выполнению макроса.

## <a name="see-also"></a>См. также

- [Сценарии Office в Excel в Интернете](../overview/excel.md)
- [Различия между сценариями Office и надстройками Office](add-ins-differences.md)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Справочник по VBA для Excel](/office/vba/api/overview/excel)
