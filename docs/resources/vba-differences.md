---
title: Различия между скриптами Office и макросами VBA
description: Различия в поведении и API между скриптами Office и макросами Excel VBA.
ms.date: 12/14/2020
localization_priority: Normal
ms.openlocfilehash: a56409a5de3eb07876faa88bfbfe78eeca59f70f
ms.sourcegitcommit: 45ffe3dbd2c834b78592ad35928cf8096f5e80bc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2021
ms.locfileid: "51755023"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a>Различия между скриптами Office и макросами VBA

Скрипты Office и макрос VBA имеют много общего. Они позволяют пользователям автоматизировать решения с помощью простого в использовании регистратора действий и позволяют изменять эти записи. Обе эти структуры предназначены для расширения возможностей людей, которые могут не считать себя программистами, создавать небольшие программы в Excel.
Основное отличие состоит в том, что макрос VBA разработан для настольных решений, а скрипты Office разработаны с помощью межплатформатной поддержки и безопасности в качестве руководящих принципов. В настоящее время скрипты Office поддерживаются только в Excel в Интернете.

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="Схема с четырьмя квадрантами, показывающая области фокусиза для различных решений для разной разностоверности Office. Оба скрипта Office и макрос VBA предназначены для помощи конечным пользователям в создании решений, но скрипты Office создаются для веб-сайтов и совместной работы (в то время как VBA — для рабочего стола).":::

В этой статье описываются основные различия между макросами VBA (а также VBA в целом) и Скриптами Office. Так как сценарии Office доступны только для Excel, это единственный хост, который обсуждается здесь.

## <a name="platform-and-ecosystem"></a>Платформа и экосистема

VBA предназначена для настольных компьютеров, а скрипты Office предназначены для интернета. VBA может взаимодействовать с рабочим столом пользователя для подключения к аналогичным технологиям, таким как COM и OLE. Однако У VBA нет удобного способа вызова в Интернете.

Скрипты Office используют универсальное время запуска для JavaScript. Это обеспечивает последовательное поведение и доступность независимо от того, используется ли машина для запуска скрипта. Они также могут звонить в другие веб-службы.

## <a name="security"></a>Безопасность

Макрос VBA имеет тот же уровень безопасности, что и Excel. Это дает им полный доступ к рабочему столу. Скрипты Office имеют доступ только к книге, а не к компьютеру, на который размещена книга. Кроме того, никакие маркеры проверки подлинности JavaScript не могут быть общими для скриптов. Это означает, что сценарий не имеет маркеров подписанного пользователя и не имеет возможностей API для регистрации во внешней службе, поэтому они не могут использовать существующие маркеры для внешних вызовов от имени пользователя.

Администраторы имеют три варианта для макрос VBA: разрешить все макрос на клиенте, не допускать макрос на клиента, или разрешить только макрос с подписанными сертификатами. Отсутствие детализации затрудняет изолирование одного плохого субъекта. В настоящее время скрипты Office либо включаем, либо отключаем для клиента. Однако мы работаем над тем, чтобы предоставить администраторам больше контроля над отдельными скриптами и создателями сценариев.

## <a name="coverage"></a>Охват

В настоящее время VBA предлагает более полное освещение функций Excel, особенно доступных на настольном клиенте. Сценарии Office охватывают почти все сценарии Excel в Интернете. Кроме того, по мере дебюта новых функций в Интернете скрипты Office будут поддерживать их как для API-записи действий, так и для API JavaScript.

Скрипты Office не поддерживают события на уровне [Excel.](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects) Скрипты запускаются только тогда, когда пользователь запускает их вручную или когда поток Power Automate вызывает сценарий.

## <a name="power-automate"></a>Power Automate

Скрипты Office можно запускать с помощью Power Automate. Ваша книга может обновляться с помощью запланированных или управляемых событиями потоков, что позволяет автоматизировать процессы без открытия Excel. Это означает, что до тех пор, пока ваша книга хранится в OneDrive (и доступна для Power Automate), поток может запускать сценарии независимо от того, используете ли вы и ваша организация настольный компьютер Excel, Mac или веб-клиент.

VBA не имеет соединитель Power Automate. Все поддерживаемые сценарии VBA связаны с пользователем, участвующим в выполнении макроса.

## <a name="see-also"></a>См. также

- [Сценарии Office в Excel в Интернете](../overview/excel.md)
- [Различия между сценариями Office и надстройками Office](add-ins-differences.md)
- [Устранение неполадок в сценариях Office](../testing/troubleshooting.md)
- [Справочник по VBA для Excel](/office/vba/api/overview/excel)
