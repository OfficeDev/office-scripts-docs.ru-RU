---
title: Различия между сценариями Office и макросами VBA
description: Различия в поведении и API между сценариями Office и макросами VBA для Excel.
ms.date: 03/23/2020
localization_priority: Normal
ms.openlocfilehash: 3a0f2c9a2ed7181a10e41d1f45b3af695877a680
ms.sourcegitcommit: d556aaefac80e55f53ac56b7f6ecbc657ebd426f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2020
ms.locfileid: "42978724"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="7357e-103">Различия между сценариями Office и макросами VBA</span><span class="sxs-lookup"><span data-stu-id="7357e-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="7357e-104">Сценарии Office и макросы VBA часто встречаются довольно часто.</span><span class="sxs-lookup"><span data-stu-id="7357e-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="7357e-105">Они оба позволяют пользователям автоматизировать решения с помощью удобного средства записи действий и разрешить изменение этих записей.</span><span class="sxs-lookup"><span data-stu-id="7357e-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="7357e-106">Обе платформы предназначены для того, чтобы помочь людям, которые не могут думать, как создавать небольшие программы в Excel.</span><span class="sxs-lookup"><span data-stu-id="7357e-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="7357e-107">Основное различие заключается в том, что макросы VBA разрабатываются для решений для настольных ПК и сценариев Office, разработанных с помощью поддержки нескольких платформ и безопасности в качестве принципов GUID.</span><span class="sxs-lookup"><span data-stu-id="7357e-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed with cross-platform support and security as the guiding principles.</span></span> <span data-ttu-id="7357e-108">В настоящее время сценарии Office поддерживаются только в Excel в Интернете.</span><span class="sxs-lookup"><span data-stu-id="7357e-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

![Схема из четырех квадрантов, в которой показаны области фокусировки для различных решений расширения Office.](../images/office-programmability-diagram.png)

<span data-ttu-id="7357e-111">В этой статье описываются основные различия между макросами VBA (а также VBA в целом) и сценариями Office.</span><span class="sxs-lookup"><span data-stu-id="7357e-111">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="7357e-112">Так как скрипты Office доступны только для Excel, это единственный рассматриваемый узел.</span><span class="sxs-lookup"><span data-stu-id="7357e-112">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="7357e-113">Платформа и экосистема</span><span class="sxs-lookup"><span data-stu-id="7357e-113">Platform and ecosystem</span></span>

<span data-ttu-id="7357e-114">VBA предназначен для настольных систем и сценариев Office, предназначенных для Интернета.</span><span class="sxs-lookup"><span data-stu-id="7357e-114">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="7357e-115">VBA может взаимодействовать с настольным компьютером пользователя.</span><span class="sxs-lookup"><span data-stu-id="7357e-115">VBA can interact with a user's desktop.</span></span> <span data-ttu-id="7357e-116">Это обеспечивает интеграцию с аналогичными технологиями, такими как COM и OLE.</span><span class="sxs-lookup"><span data-stu-id="7357e-116">This lets it integrate with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="7357e-117">Однако VBA не имеет удобного способа позвонить в Интернет.</span><span class="sxs-lookup"><span data-stu-id="7357e-117">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="7357e-118">Сценарии Office используют универсальную среду выполнения или JavaScript.</span><span class="sxs-lookup"><span data-stu-id="7357e-118">Office Scripts use a universal runtime or JavaScript.</span></span> <span data-ttu-id="7357e-119">Это обеспечивает согласованное поведение и специальные возможности, независимо от компьютера, используемого для запуска сценария.</span><span class="sxs-lookup"><span data-stu-id="7357e-119">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="7357e-120">Они также могут совершать вызовы другим веб-службам.</span><span class="sxs-lookup"><span data-stu-id="7357e-120">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="7357e-121">Безопасность</span><span class="sxs-lookup"><span data-stu-id="7357e-121">Security</span></span>

<span data-ttu-id="7357e-122">Макросы VBA имеют тот же зазор безопасности, что и Excel.</span><span class="sxs-lookup"><span data-stu-id="7357e-122">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="7357e-123">Это дает им полный доступ к рабочему столу.</span><span class="sxs-lookup"><span data-stu-id="7357e-123">This gives them full access to your desktop.</span></span> <span data-ttu-id="7357e-124">Сценарии Office имеют доступ только к книге, а не к компьютеру, на котором размещена книга.</span><span class="sxs-lookup"><span data-stu-id="7357e-124">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="7357e-125">Кроме того, с скриптами нельзя предоставлять доступ к маркерам проверки подлинности JavaScript, поэтому сценарии никогда не проходят проверку подлинности с помощью внешней службы.</span><span class="sxs-lookup"><span data-stu-id="7357e-125">Additionally, no JavaScript authentication tokens can be shared with scripts, so scripts can never authenticate with an external service.</span></span>

<span data-ttu-id="7357e-126">У администраторов есть три варианта макросов VBA: разрешить все макросы в клиенте, не разрешать макросы в клиенте или разрешать только макросы с подписанными сертификатами.</span><span class="sxs-lookup"><span data-stu-id="7357e-126">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="7357e-127">Такой недостаток детализации заключается в том, чтобы изолировать одного неисправного субъекта.</span><span class="sxs-lookup"><span data-stu-id="7357e-127">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="7357e-128">В настоящее время сценарии Office либо включены, либо отключены для клиента.</span><span class="sxs-lookup"><span data-stu-id="7357e-128">Currently, Office Scripts are either on or off for a tenant.</span></span> <span data-ttu-id="7357e-129">Однако мы работаем над предоставлением администраторам более контроля над отдельными сценариями и авторами сценариев.</span><span class="sxs-lookup"><span data-stu-id="7357e-129">However, we are working to give admins more control over individual scripts and script creators.</span></span>

## <a name="coverage"></a><span data-ttu-id="7357e-130">Потребностей</span><span class="sxs-lookup"><span data-stu-id="7357e-130">Coverage</span></span>

<span data-ttu-id="7357e-131">В настоящее время VBA предлагает более полное покрытие функций Excel, особенно доступных на настольном клиенте.</span><span class="sxs-lookup"><span data-stu-id="7357e-131">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="7357e-132">Сценарии Office охватывают практически все сценарии для Excel в Интернете.</span><span class="sxs-lookup"><span data-stu-id="7357e-132">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="7357e-133">Кроме того, когда новые функции появятся в Интернете, сценарии Office будут поддерживать их как для средства записи действий, так и для API JavaScript.</span><span class="sxs-lookup"><span data-stu-id="7357e-133">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

## <a name="power-automate"></a><span data-ttu-id="7357e-134">Автоматизация управления питанием</span><span class="sxs-lookup"><span data-stu-id="7357e-134">Power Automate</span></span>

<span data-ttu-id="7357e-135">Сценарии Office можно запускать с помощью автоматизации управления питанием.</span><span class="sxs-lookup"><span data-stu-id="7357e-135">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="7357e-136">Книгу можно обновить с помощью запланированных или управляемых событиями потоков, позволяя автоматизировать рабочие процессы, даже не открывая Excel.</span><span class="sxs-lookup"><span data-stu-id="7357e-136">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="7357e-137">Это означает, что если книга хранится в OneDrive (и доступна для автоматизации), поток может выполнять свои сценарии независимо от того, используете ли вы и ваша организация, Office, Mac или веб-клиент.</span><span class="sxs-lookup"><span data-stu-id="7357e-137">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="7357e-138">VBA не присвоена интеграция с Power автоматизируем.</span><span class="sxs-lookup"><span data-stu-id="7357e-138">VBA has no integration with Power Automate.</span></span> <span data-ttu-id="7357e-139">Все поддерживаемые сценарии VBA применяют пользователя к выполнению макроса.</span><span class="sxs-lookup"><span data-stu-id="7357e-139">All supported VBA scenarios involved a user attending to the macro's execution.</span></span>

## <a name="see-also"></a><span data-ttu-id="7357e-140">См. также</span><span class="sxs-lookup"><span data-stu-id="7357e-140">See also</span></span>

- [<span data-ttu-id="7357e-141">Сценарии Office в Excel в Интернете</span><span class="sxs-lookup"><span data-stu-id="7357e-141">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="7357e-142">Различия между сценариями Office и надстройками Office</span><span class="sxs-lookup"><span data-stu-id="7357e-142">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="7357e-143">Устранение неполадок в сценариях Office</span><span class="sxs-lookup"><span data-stu-id="7357e-143">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="7357e-144">Справочник по VBA для Excel</span><span class="sxs-lookup"><span data-stu-id="7357e-144">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
